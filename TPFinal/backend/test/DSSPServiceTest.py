import unittest
import os

from backend.service.DSSPService import DSSPService


class DSSPServiceTest(unittest.TestCase):
    dssp = DSSPService()

    def test_path_valid(self):
        os.chdir("C:\\Users\\pmarrero\\Desktop\\BioInformatica\\TPFinal\\backend\\service")
        self.dssp.obtain_dssp("1GJZ", "A")

    def test_align_between_secondary_and_primary_structure(self):
        os.chdir("C:\\Users\\pmarrero\\Desktop\\BioInformatica\\TPFinal\\backend\\service")
        secondary = ([(1, 'G', '-', 0.8571428571428571, 360.0, -45.0, 0, 0.0, 16, -0.0, 0, 0.0, 18, -0.0),
                      (2, 'S', '-', 0.8769230769230769, -61.3, -44.8, 1, -0.2, 16, -0.0, 18, -0.0, 18, -0.0),
                      (3, 'M', 'S', 0.2872340425531915, -167.0, 52.9, 17, -0.1, 16, -0.7, 2, -0.1, 2, -0.5),
                      (4, 'Q', 'E', 0.42424242424242425, -61.6, 110.6, 14, -0.3, 14, -0.3, 12, -0.1, 2, -0.1),
                      (5, 'I', 'E', 0.005917159763313609, -72.5, 146.2, 12, -3.7, 12, -0.9, -2, -0.5, 2, -0.4),
                      (6, 'F', 'E', 0.49238578680203043, -87.8, 130.4, 93, -1.3, 95, -1.5, 10, -0.2, 2, -0.3),
                      (7, 'V', 'E', 0.056338028169014086, -144.5, 151.0, 8, -1.4, 8, -2.6, -2, -0.4, 2, -0.5),
                      (8, 'K', 'E', 0.6146341463414634, -120.0, 118.0, 93, -2.3, 95, -0.7, -2, -0.3, 6, -0.2),
                      (9, 'T', '-', 0.09859154929577464, -68.7, 152.7, 4, -1.9, 3, -0.2, -2, -0.5, 6, -0.0),
                      (10, 'L', 'S', 0.5670731707317073, -50.3, -37.7, 1, -0.2, -1, -0.1, 2, -0.1, 92, -0.0),
                      (11, 'T', 'S', 0.8802816901408451, -66.6, -45.0, 2, -0.1, -1, -0.2, 1, -0.1, -3, -0.0),
                      (12, 'G', 'S', 0.4642857142857143, 144.0, -40.1, 1, -0.4, -3, -0.1, -3, -0.2, -2, -0.1),
                      (13, 'K', '-', 0.5414634146341464, -52.1, 139.7, -5, -0.1, -4, -1.9, 1, -0.1, -1, -0.4),
                      (14, 'T', 'E', 0.7887323943661971, -73.3, 148.1, -6, -0.2, 2, -0.4, -8, -0.0, -6, -0.2),
                      (15, 'I', 'E', 0.08875739644970414, -134.8, 133.3, -8, -2.6, -8, -1.4, -2, -0.1, 2, -0.3),
                      (16, 'T', 'E', 0.5915492957746479, -106.2, 145.3, -2, -0.4, 2, -0.3, -10, -0.2, -10, -0.2),
                      (17, 'L', 'E', 0.03048780487804878, -155.3, 113.8, -12, -0.9, -12, -3.7, -2, -0.3, 2, -0.3),
                      (18, 'E', 'E', 0.6082474226804123, -80.4, 136.7, -14, -0.3, 2, -0.3, -2, -0.3, -14, -0.3),
                      (19, 'V', '-', 0.07042253521126761, -158.2, 143.5, -16, -0.7, -2, -0.1, -2, -0.3, 9, -0.0),
                      (20, 'E', '-', 0.6494845360824743, -62.8, 133.8, -2, -0.3, 3, -0.8, 1, -0.1, 59, -0.2),
                      (21, 'P', 'T', 0.4338235294117647, -55.2, -38.8, 0, 0.0, 59, -1.0, 0, 0.0, 58, -0.9),
                      (22, 'S', 'T', 0.46153846153846156, -64.7, -31.6, 57, -0.2, 3, -0.1, 56, -0.2, 59, -0.1),
                      (23, 'D', 'S', 0.2392638036809816, -52.4, 135.3, -3, -0.8, 56, -0.9, 55, -0.1, 57, -0.1),
                      (24, 'T', 'B', 0.2676056338028169, -56.7, 143.8, 54, -0.2, 4, -2.3, 1, -0.1, 54, -0.2),
                      (25, 'I', 'H', 0.023668639053254437, -57.3, -44.4, 50, -1.0, 4, -2.7, 52, -0.9, 5, -0.3),
                      (26, 'E', 'H', 0.520618556701031, -57.0, -41.9, 49, -1.0, 4, -2.2, 1, -0.2, -1, -0.2),
                      (27, 'N', 'H', 0.4840764331210191, -65.7, -43.0, 2, -0.2, 4, -1.5, 48, -0.2, -1, -0.2),
                      (28, 'V', 'H', 0.0, -59.6, -49.8, -4, -2.3, 4, -1.0, 1, -0.2, 3, -0.4),
                      (29, 'K', 'H', 0.03414634146341464, -62.5, -39.8, -4, -2.7, 4, -0.9, 1, -0.2, 3, -0.5),
                      (30, 'A', 'H', 0.3018867924528302, -56.2, -35.7, -4, -2.2, 4, -1.2, -5, -0.3, 3, -0.6),
                      (31, 'K', 'H', 0.3853658536585366, -65.4, -36.5, -4, -1.5, 4, -2.5, -3, -0.4, -1, -0.3),
                      (32, 'I', 'H', 0.011834319526627219, -55.8, -31.4, -4, -1.0, 4, -1.8, -3, -0.5, 5, -0.6),
                      (33, 'Q', 'H', 0.3686868686868687, -61.1, -52.5, -4, -0.9, 3, -0.6, -3, -0.6, -1, -0.2),
                      (34, 'D', 'H', 0.8588957055214724, -59.4, -34.7, -4, -1.2, -2, -0.2, 1, -0.3, -1, -0.2),
                      (35, 'K', 'H', 0.3902439024390244, -65.9, -33.4, -4, -2.5, -1, -0.3, -5, -0.1, -2, -0.2),
                      (36, 'E', 'T', 0.5257731958762887, -141.7, -70.7, -4, -1.8, -3, -0.2, -3, -0.6, -2, -0.1),
                      (37, 'G', '-', 0.6785714285714286, 143.5, 54.3, -5, -0.6, -4, -0.2, 1, -0.2, -3, -0.1),
                      (38, 'I', '-', 0.07692307692307693, -138.4, 128.1, -9, -0.2, -1, -0.2, -8, -0.1, 5, -0.1),
                      (39, 'P', '-', 0.40441176470588236, -44.0, 141.2, 0, 0.0, 4, -1.1, 0, 0.0, 3, -0.8),
                      (40, 'P', 'T', 0.22794117647058823, -57.8, -35.0, 0, 0.0, 3, -0.1, 0, 0.0, -10, -0.0),
                      (41, 'D', 'T', 0.9325153374233128, -60.0, -37.9, 1, -0.2, -15, -0.0, 3, -0.1, -12, -0.0),
                      (42, 'Q', 'T', 0.17676767676767677, -60.7, -44.9, -3, -0.8, -1, -0.2, 61, -0.1, 60, -0.1),
                      (43, 'Q', 'S', 0.03535353535353535, -54.3, 125.5, -4, -1.1, 2, -0.6, 60, -0.2, 60, -0.3),
                      (44, 'R', '-', 0.42338709677419356, -85.8, 122.0, 58, -0.9, 2, -0.4, 15, -0.0, -1, -0.1),
                      (45, 'L', '-', 0.036585365853658534, -84.3, 133.0, -2, -0.6, 15, -1.2, 56, -0.2, 2, -0.3),
                      (46, 'I', 'E', 0.31952662721893493, -143.2, 145.5, 54, -1.2, 54, -1.1, -2, -0.4, 2, -0.4),
                      (47, 'F', 'E', 0.0, -133.9, 140.1, 13, -1.4, 15, -2.4, -2, -0.3, 2, -0.3),
                      (48, 'A', 'E', 0.12264150943396226, -153.2, 119.2, -2, -0.4, 50, -0.9, 13, -0.2, 2, -0.2),
                      (49, 'G', '-', 0.05952380952380952, -75.8, 138.8, 13, -0.7, 48, -0.2, -2, -0.3, 47, -0.1),
                      (50, 'K', '-', 0.526829268292683, -149.3, 74.6, -2, -0.2, 2, -0.9, 46, -0.0, -1, -0.1),
                      (51, 'Q', '-', 0.5606060606060606, -67.3, 103.6, 1, -0.1, 2, -1.5, -2, -0.1, -2, -0.0),
                      (52, 'L', '-', 0.9573170731707317, -45.1, 80.4, -2, -0.9, -1, -0.1, 1, -0.1, -2, -0.0),
                      (53, 'E', '-', 1.0, -61.2, 360.0, -2, -1.5, -1, -0.1, 0, 0.0, 0, 0.0)],
                     ([('A', (' ', -1, ' '))], [('A', (' ', 51, ' '))]))
        primary = "------GSMQIFVKTLTGKTITLEVEPSDTIENVKAKIQDKEGIPPDQQRLIFAGKQLE-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------"
        self.dssp.align(secondary, primary)

    def test_conservate_secondary_and_primary_structure(self):
        os.chdir("C:\\Users\\pmarrero\\Desktop\\BioInformatica\\TPFinal\\backend\\service")
        aligments = [('1UBQ_A', '--------MQIFVKTLTGKTITLEVEPSDTIENVKAKIQDKEGIPPDQQRLIFAGKQLEDGRTLSDYNIQKESTLHLVLRLRGG----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'), ('5ZBI_A', 'MAHHHHHHMQIFVKTLTGKTITLEVEPSDTIENVKAKIQDKEGIPPDQQRLIFAGKQLEDGRTLSDYNIQKESTLHLVLRLRGGRDITGDGFLRLPSHGNGNSGDVDSKAGTKWAVLIAGSKGYQNYRHQADVCHAYQILRKGGVKDENIIVFMYDDIAYDIRNPYPGTIINSPDKKDVYKGVPKDYTGEDVNVQNFLAVILGNKTALTGGSGKVLDTRPNDHIFIYYTDHGYPGVLGMPTEPYLYANDLIDTLKKKHALGTYEGLVFYVEACESASIFEGLLPDGLNIYVSTAAKAGEGSWVAYCPSQEPPVPAEYGTCVGDLYSVTWMEDSDVYNLRTQTLHQQYELVKNKIAYASTVSQFGDFPISKDSLFEYMGTDPANEKRQYEDEEKSSSPHVGAVHQREADLHHFWDKYQKASEGSRNKVDARKQLVEVMLHRMHVDDSIESIAKLLFGSGAKASEMMNTIRPPGQPLVSDWDCLKTMVRTFETHCGSLSEYGMKYTRFLANICNSGIQKEKMGEASAQVCLNFP'), ('2MSG_A', '--------MQIFVKTLTGKTITLEVEPSDTIENVKAKIQDKEGIPPDQQRLIFAGKQLEDGRTLSDYNIQKESTLHLVLR--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'), ('2N2K_B', '--------MQIFVKTLTGKTITLEVEPSDTIENVKAKIQDKEGIPPDQQRLIFAGKQLEDGRTLSDYNIQKESTLHLVL---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'), ('1GJZ_A', '------GSMQIFVKTLTGKTITLEVEPSDTIENVKAKIQDKEGIPPDQQRLIFAGKQLE-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'), ('3AI5_A', '-----GSHMSKGEELFTG-VVPILVELDGDVNGHKFSVSG-------------------EGEGDATYG---KLTLKFICT-TGKLPVPWPTLVT--TFGYG----VQCFAR------------YPDHMKQHDFFKS--AMPEGYVQERT--IFFKDD----------GN----------YK------TRAEVKFEG---DTLVNRIELKG-----IDFKEDGNILGHKLEYNYN-----SHNVYIMAD------KQK---------------------------NGIKVNFKIRHNIEDGS-VQLADHYQQNTP------IGD--GPVLLPDNH---------------------YLSTQS-----ALSKDP----------NEKRD---------HMVLLEFVTAAGITGSMQIFVKTLTGKTITLEVEP------------SDTIENVK-------AKIQDKEG-IPPDQQRLIFAG-------KQLE-DGRTLSDYN--------------IQKES----TLHLVLRLR')]
        self.dssp.conservate(aligments)

    def test_write_file(self):
        os.chdir("C:\\Users\\pmarrero\\Desktop\\BioInformatica\\TPFinal\\backend\\service")
        self.dssp._writeFile([('1UBQ_A', '--------MQIFVKTLTGKTITLEVEPSDTIENVKAKIQDKEGIPPDQQRLIFAGKQLEDGRTLSDYNIQKESTLHLVLRLRGG----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'), ('5ZBI_A', 'MAHHHHHHMQIFVKTLTGKTITLEVEPSDTIENVKAKIQDKEGIPPDQQRLIFAGKQLEDGRTLSDYNIQKESTLHLVLRLRGGRDITGDGFLRLPSHGNGNSGDVDSKAGTKWAVLIAGSKGYQNYRHQADVCHAYQILRKGGVKDENIIVFMYDDIAYDIRNPYPGTIINSPDKKDVYKGVPKDYTGEDVNVQNFLAVILGNKTALTGGSGKVLDTRPNDHIFIYYTDHGYPGVLGMPTEPYLYANDLIDTLKKKHALGTYEGLVFYVEACESASIFEGLLPDGLNIYVSTAAKAGEGSWVAYCPSQEPPVPAEYGTCVGDLYSVTWMEDSDVYNLRTQTLHQQYELVKNKIAYASTVSQFGDFPISKDSLFEYMGTDPANEKRQYEDEEKSSSPHVGAVHQREADLHHFWDKYQKASEGSRNKVDARKQLVEVMLHRMHVDDSIESIAKLLFGSGAKASEMMNTIRPPGQPLVSDWDCLKTMVRTFETHCGSLSEYGMKYTRFLANICNSGIQKEKMGEASAQVCLNFP'), ('2MSG_A', '--------MQIFVKTLTGKTITLEVEPSDTIENVKAKIQDKEGIPPDQQRLIFAGKQLEDGRTLSDYNIQKESTLHLVLR--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'), ('2N2K_B', '--------MQIFVKTLTGKTITLEVEPSDTIENVKAKIQDKEGIPPDQQRLIFAGKQLEDGRTLSDYNIQKESTLHLVL---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'), ('1GJZ_A', '------GSMQIFVKTLTGKTITLEVEPSDTIENVKAKIQDKEGIPPDQQRLIFAGKQLE-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'), ('3AI5_A', '-----GSHMSKGEELFTG-VVPILVELDGDVNGHKFSVSG-------------------EGEGDATYG---KLTLKFICT-TGKLPVPWPTLVT--TFGYG----VQCFAR------------YPDHMKQHDFFKS--AMPEGYVQERT--IFFKDD----------GN----------YK------TRAEVKFEG---DTLVNRIELKG-----IDFKEDGNILGHKLEYNYN-----SHNVYIMAD------KQK---------------------------NGIKVNFKIRHNIEDGS-VQLADHYQQNTP------IGD--GPVLLPDNH---------------------YLSTQS-----ALSKDP----------NEKRD---------HMVLLEFVTAAGITGSMQIFVKTLTGKTITLEVEP------------SDTIENVK-------AKIQDKEG-IPPDQQRLIFAG-------KQLE-DGRTLSDYN--------------IQKES----TLHLVLRLR')]
        )

if __name__ == '__main__':
    unittest.main()
