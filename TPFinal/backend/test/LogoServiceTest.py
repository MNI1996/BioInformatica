import unittest
import os

from backend.service.LogoService import LogoService


class LogoServiceTest(unittest.TestCase):
    logoService = LogoService()

    def test_parse_seq(self):
        seq = '--------MQIFVKTLTGKTITLEVEPSDTIENVKAKIQDKEGIPPDQQRLIFAGKQLEDGRTLSDYNIQKESTLHLVLRLRGG----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'
        ret = self.logoService.parseSeq(seq)
        self.assertEqual(len(ret), 18)
        self.assertEqual(['--------MQIFVKTLTGKTITLEVEPSD', 'KTITLEVEPSDTIENVKAKIQDKEGIPPD', 'KIQDKEGIPPDQQRLIFAGKQLEDGRTLS', 'GKQLEDGRTLSDYNIQKESTLHLVLRLRG', 'STLHLVLRLRGG-----------------', '-----------------------------', '-----------------------------', '-----------------------------', '-----------------------------', '-----------------------------', '-----------------------------', '-----------------------------', '-----------------------------', '-----------------------------', '-----------------------------', '-----------------------------', '-----------------------------', '-----------------------------']
                         ,ret)

    def test_list_homologas(self):
        seqs= [('1UBQ', '--------MQIFVKTLTGKTITLEVEPSDTIENVKAKIQDKEGIPPDQQRLIFAGKQLEDGRTLSDYNIQKESTLHLVLRLRGG----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'), ('5ZBI', 'MAHHHHHHMQIFVKTLTGKTITLEVEPSDTIENVKAKIQDKEGIPPDQQRLIFAGKQLEDGRTLSDYNIQKESTLHLVLRLRGGRDITGDGFLRLPSHGNGNSGDVDSKAGTKWAVLIAGSKGYQNYRHQADVCHAYQILRKGGVKDENIIVFMYDDIAYDIRNPYPGTIINSPDKKDVYKGVPKDYTGEDVNVQNFLAVILGNKTALTGGSGKVLDTRPNDHIFIYYTDHGYPGVLGMPTEPYLYANDLIDTLKKKHALGTYEGLVFYVEACESASIFEGLLPDGLNIYVSTAAKAGEGSWVAYCPSQEPPVPAEYGTCVGDLYSVTWMEDSDVYNLRTQTLHQQYELVKNKIAYASTVSQFGDFPISKDSLFEYMGTDPANEKRQYEDEEKSSSPHVGAVHQREADLHHFWDKYQKASEGSRNKVDARKQLVEVMLHRMHVDDSIESIAKLLFGSGAKASEMMNTIRPPGQPLVSDWDCLKTMVRTFETHCGSLSEYGMKYTRFLANICNSGIQKEKMGEASAQVCLNFP'), ('2MSG', '--------MQIFVKTLTGKTITLEVEPSDTIENVKAKIQDKEGIPPDQQRLIFAGKQLEDGRTLSDYNIQKESTLHLVLR--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'), ('2N2K', '--------MQIFVKTLTGKTITLEVEPSDTIENVKAKIQDKEGIPPDQQRLIFAGKQLEDGRTLSDYNIQKESTLHLVL---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'), ('1GJZ', '------GSMQIFVKTLTGKTITLEVEPSDTIENVKAKIQDKEGIPPDQQRLIFAGKQLE-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'), ('3AI5', '-----GSHMSKGEELFTG-VVPILVELDGDVNGHKFSVSG-------------------EGEGDATYG---KLTLKFICT-TGKLPVPWPTLVT--TFGYG----VQCFAR------------YPDHMKQHDFFKS--AMPEGYVQERT--IFFKDD----------GN----------YK------TRAEVKFEG---DTLVNRIELKG-----IDFKEDGNILGHKLEYNYN-----SHNVYIMAD------KQK---------------------------NGIKVNFKIRHNIEDGS-VQLADHYQQNTP------IGD--GPVLLPDNH---------------------YLSTQS-----ALSKDP----------NEKRD---------HMVLLEFVTAAGITGSMQIFVKTLTGKTITLEVEP------------SDTIENVK-------AKIQDKEG-IPPDQQRLIFAG-------KQLE-DGRTLSDYN--------------IQKES----TLHLVLRLR')]
        ret = self.logoService.listHomologas(seqs)
        self.assertEqual([['--------MQIFVKTLTGKTITLEVEPSD', 'MAHHHHHHMQIFVKTLTGKTITLEVEPSD', '--------MQIFVKTLTGKTITLEVEPSD', '--------MQIFVKTLTGKTITLEVEPSD', '------GSMQIFVKTLTGKTITLEVEPSD', '-----GSHMSKGEELFTG-VVPILVELDG'], ['KTITLEVEPSDTIENVKAKIQDKEGIPPD', 'KTITLEVEPSDTIENVKAKIQDKEGIPPD', 'KTITLEVEPSDTIENVKAKIQDKEGIPPD', 'KTITLEVEPSDTIENVKAKIQDKEGIPPD', 'KTITLEVEPSDTIENVKAKIQDKEGIPPD', '-VVPILVELDGDVNGHKFSVSG-------'], ['KIQDKEGIPPDQQRLIFAGKQLEDGRTLS', 'KIQDKEGIPPDQQRLIFAGKQLEDGRTLS', 'KIQDKEGIPPDQQRLIFAGKQLEDGRTLS', 'KIQDKEGIPPDQQRLIFAGKQLEDGRTLS', 'KIQDKEGIPPDQQRLIFAGKQLE------', 'SVSG-------------------EGEGDA'], ['GKQLEDGRTLSDYNIQKESTLHLVLRLRG', 'GKQLEDGRTLSDYNIQKESTLHLVLRLRG', 'GKQLEDGRTLSDYNIQKESTLHLVLR---', 'GKQLEDGRTLSDYNIQKESTLHLVL----', 'GKQLE------------------------', '-----EGEGDATYG---KLTLKFICT-TG'], ['STLHLVLRLRGG-----------------', 'STLHLVLRLRGGRDITGDGFLRLPSHGNG', 'STLHLVLR---------------------', 'STLHLVL----------------------', '-----------------------------', 'LTLKFICT-TGKLPVPWPTLVT--TFGYG'], ['-----------------------------', 'GFLRLPSHGNGNSGDVDSKAGTKWAVLIA', '-----------------------------', '-----------------------------', '-----------------------------', 'TLVT--TFGYG----VQCFAR--------'], ['-----------------------------', 'KAGTKWAVLIAGSKGYQNYRHQADVCHAY', '-----------------------------', '-----------------------------', '-----------------------------', 'FAR------------YPDHMKQHDFFKS-'], ['-----------------------------', 'YRHQADVCHAYQILRKGGVKDENIIVFMY', '-----------------------------', '-----------------------------', '-----------------------------', 'HMKQHDFFKS--AMPEGYVQERT--IFFK'], ['-----------------------------', 'VKDENIIVFMYDDIAYDIRNPYPGTIINS', '-----------------------------', '-----------------------------', '-----------------------------', 'VQERT--IFFKDD----------GN----'], ['-----------------------------', 'RNPYPGTIINSPDKKDVYKGVPKDYTGED', '-----------------------------', '-----------------------------', '-----------------------------', '-----GN----------YK------TRAE'], ['-----------------------------', 'KGVPKDYTGEDVNVQNFLAVILGNKTALT', '-----------------------------', '-----------------------------', '-----------------------------', 'K------TRAEVKFEG---DTLVNRIELK'], ['-----------------------------', 'AVILGNKTALTGGSGKVLDTRPNDHIFIY', '-----------------------------', '-----------------------------', '-----------------------------', '-DTLVNRIELKG-----IDFKEDGNILGH'], ['-----------------------------', 'DTRPNDHIFIYYTDHGYPGVLGMPTEPYL', '-----------------------------', '-----------------------------', '-----------------------------', 'DFKEDGNILGHKLEYNYN-----SHNVYI'], ['-----------------------------', 'GVLGMPTEPYLYANDLIDTLKKKHALGTY', '-----------------------------', '-----------------------------', '-----------------------------', '-----SHNVYIMAD------KQK------'], ['-----------------------------', 'TLKKKHALGTYEGLVFYVEACESASIFEG', '-----------------------------', '-----------------------------', '-----------------------------', '--KQK------------------------'], ['-----------------------------', 'EACESASIFEGLLPDGLNIYVSTAAKAGE', '-----------------------------', '-----------------------------', '-----------------------------', '--------------NGIKVNFKIRHNIED'], ['-----------------------------', 'IYVSTAAKAGEGSWVAYCPSQEPPVPAEY', '-----------------------------', '-----------------------------', '-----------------------------', 'VNFKIRHNIEDGS-VQLADHYQQNTP---'], ['-----------------------------', 'PSQEPPVPAEYGTCVGDLYSVTWMEDSDV', '-----------------------------', '-----------------------------', '-----------------------------', 'DHYQQNTP------IGD--GPVLLPDNH-']], ret)

    def test_logo_maker(self):
        pseqs = ['--------MQIFVKTLTGKTITLEVEPSD', 'MAHHHHHHMQIFVKTLTGKTITLEVEPSD', '--------MQIFVKTLTGKTITLEVEPSD', '--------MQIFVKTLTGKTITLEVEPSD', '------GSMQIFVKTLTGKTITLEVEPSD', '-----GSHMSKGEELFTG-VVPILVELDG']
        id = "1UBQ"
        n = 0

        os.chdir("C:\\Users\\pmarrero\\Desktop\\BioInformatica\\TPFinal\\backend")
        self.logoService.logoMaker(pseqs, id, n)

    def test_logo_maker_n(self):
        pseqs = ['--------MQIFVKTLTGKTITLEVEPSD', 'MAHHHHHHMQIFVKTLTGKTITLEVEPSD', '--------MQIFVKTLTGKTITLEVEPSD',
                     '--------MQIFVKTLTGKTITLEVEPSD', '------GSMQIFVKTLTGKTITLEVEPSD', '-----GSHMSKGEELFTG-VVPILVELDG']
        id = "1UBQ"
        n = 0

        os.chdir("C:\\Users\\pmarrero\\Desktop\\BioInformatica\\TPFinal\\backend")
        self.logoService.logoMaker(pseqs, id, n)

    def test_multi_logo(self):
        seqs= [['--------MQIFVKTLTGKTITLEVEPSD', 'MAHHHHHHMQIFVKTLTGKTITLEVEPSD', '--------MQIFVKTLTGKTITLEVEPSD', '--------MQIFVKTLTGKTITLEVEPSD', '------GSMQIFVKTLTGKTITLEVEPSD', '-----GSHMSKGEELFTG-VVPILVELDG'], ['KTITLEVEPSDTIENVKAKIQDKEGIPPD', 'KTITLEVEPSDTIENVKAKIQDKEGIPPD', 'KTITLEVEPSDTIENVKAKIQDKEGIPPD', 'KTITLEVEPSDTIENVKAKIQDKEGIPPD', 'KTITLEVEPSDTIENVKAKIQDKEGIPPD', '-VVPILVELDGDVNGHKFSVSG-------'], ['KIQDKEGIPPDQQRLIFAGKQLEDGRTLS', 'KIQDKEGIPPDQQRLIFAGKQLEDGRTLS', 'KIQDKEGIPPDQQRLIFAGKQLEDGRTLS', 'KIQDKEGIPPDQQRLIFAGKQLEDGRTLS', 'KIQDKEGIPPDQQRLIFAGKQLE------', 'SVSG-------------------EGEGDA'], ['GKQLEDGRTLSDYNIQKESTLHLVLRLRG', 'GKQLEDGRTLSDYNIQKESTLHLVLRLRG', 'GKQLEDGRTLSDYNIQKESTLHLVLR---', 'GKQLEDGRTLSDYNIQKESTLHLVL----', 'GKQLE------------------------', '-----EGEGDATYG---KLTLKFICT-TG'], ['STLHLVLRLRGG-----------------', 'STLHLVLRLRGGRDITGDGFLRLPSHGNG', 'STLHLVLR---------------------', 'STLHLVL----------------------', '-----------------------------', 'LTLKFICT-TGKLPVPWPTLVT--TFGYG'], ['-----------------------------', 'GFLRLPSHGNGNSGDVDSKAGTKWAVLIA', '-----------------------------', '-----------------------------', '-----------------------------', 'TLVT--TFGYG----VQCFAR--------'], ['-----------------------------', 'KAGTKWAVLIAGSKGYQNYRHQADVCHAY', '-----------------------------', '-----------------------------', '-----------------------------', 'FAR------------YPDHMKQHDFFKS-'], ['-----------------------------', 'YRHQADVCHAYQILRKGGVKDENIIVFMY', '-----------------------------', '-----------------------------', '-----------------------------', 'HMKQHDFFKS--AMPEGYVQERT--IFFK'], ['-----------------------------', 'VKDENIIVFMYDDIAYDIRNPYPGTIINS', '-----------------------------', '-----------------------------', '-----------------------------', 'VQERT--IFFKDD----------GN----'], ['-----------------------------', 'RNPYPGTIINSPDKKDVYKGVPKDYTGED', '-----------------------------', '-----------------------------', '-----------------------------', '-----GN----------YK------TRAE'], ['-----------------------------', 'KGVPKDYTGEDVNVQNFLAVILGNKTALT', '-----------------------------', '-----------------------------', '-----------------------------', 'K------TRAEVKFEG---DTLVNRIELK'], ['-----------------------------', 'AVILGNKTALTGGSGKVLDTRPNDHIFIY', '-----------------------------', '-----------------------------', '-----------------------------', '-DTLVNRIELKG-----IDFKEDGNILGH'], ['-----------------------------', 'DTRPNDHIFIYYTDHGYPGVLGMPTEPYL', '-----------------------------', '-----------------------------', '-----------------------------', 'DFKEDGNILGHKLEYNYN-----SHNVYI'], ['-----------------------------', 'GVLGMPTEPYLYANDLIDTLKKKHALGTY', '-----------------------------', '-----------------------------', '-----------------------------', '-----SHNVYIMAD------KQK------'], ['-----------------------------', 'TLKKKHALGTYEGLVFYVEACESASIFEG', '-----------------------------', '-----------------------------', '-----------------------------', '--KQK------------------------'], ['-----------------------------', 'EACESASIFEGLLPDGLNIYVSTAAKAGE', '-----------------------------', '-----------------------------', '-----------------------------', '--------------NGIKVNFKIRHNIED'], ['-----------------------------', 'IYVSTAAKAGEGSWVAYCPSQEPPVPAEY', '-----------------------------', '-----------------------------', '-----------------------------', 'VNFKIRHNIEDGS-VQLADHYQQNTP---'], ['-----------------------------', 'PSQEPPVPAEYGTCVGDLYSVTWMEDSDV', '-----------------------------', '-----------------------------', '-----------------------------', 'DHYQQNTP------IGD--GPVLLPDNH-']]
        id = "1UBQ"
        os.chdir("C:\\Users\\pmarrero\\Desktop\\BioInformatica\\TPFinal\\backend")

        self.logoService.multiLogo(seqs, id)

if __name__ == '__main__':
    unittest.main()
